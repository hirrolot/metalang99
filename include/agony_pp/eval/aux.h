#ifndef AGONY_PP_PRIVATE_AUX_H
#define AGONY_PP_PRIVATE_AUX_H

#define AGONY_PP_PRIVATE_EVAL_AUX_EMPTY()
#define AGONY_PP_PRIVATE_EVAL_AUX_EXPAND(...)         __VA_ARGS__
#define AGONY_PP_PRIVATE_EVAL_AUX_COMMA()             ,
#define AGONY_PP_PRIVATE_EVAL_AUX_CALL_MACRO(op, ...) op(__VA_ARGS__)

#define AGONY_PP_PRIVATE_EVAL_AUX_PARENTHESISE(...) (__VA_ARGS__)
#define AGONY_PP_PRIVATE_EVAL_AUX_UNPARENTHESISE(x)                                                \
    AGONY_PP_PRIVATE_EVAL_AUX_EXPAND(AGONY_PP_PRIVATE_EVAL_AUX_EXPAND x)

#define AGONY_PP_PRIVATE_EVAL_AUX_CAT(x, y)           AGONY_PP_PRIVATE_EVAL_AUX_PRIMITIVE_CAT(x, y)
#define AGONY_PP_PRIVATE_EVAL_AUX_PRIMITIVE_CAT(x, y) x##y

#define AGONY_PP_PRIVATE_EVAL_AUX_MATCH(op, pattern) AGONY_PP_PRIVATE_EVAL_AUX_CAT(op, pattern)

#define AGONY_PP_PRIVATE_EVAL_AUX_HEAD(...)        AGONY_PP_PRIVATE_EVAL_AUX_HEAD_AUX(__VA_ARGS__)
#define AGONY_PP_PRIVATE_EVAL_AUX_HEAD_AUX(x, ...) x

#define AGONY_PP_PRIVATE_EVAL_AUX_TAIL(...)        AGONY_PP_PRIVATE_EVAL_AUX_TAIL_AUX(__VA_ARGS__)
#define AGONY_PP_PRIVATE_EVAL_AUX_TAIL_AUX(x, ...) __VA_ARGS__

#define AGONY_PP_PRIVATE_EVAL_AUX_EMPTY_ACC() (AGONY_PP_PRIVATE_EVAL_AUX_EMPTY())
#define AGONY_PP_PRIVATE_EVAL_AUX_EXTEND_PARENTHESISED(acc, ...)                                   \
    (AGONY_PP_PRIVATE_EVAL_AUX_UNPARENTHESISE(acc) __VA_ARGS__)

#define AGONY_PP_PRIVATE_EVAL_AUX_IF(cond, x, y)                                                   \
    AGONY_PP_PRIVATE_EVAL_AUX_MATCH(AGONY_PP_PRIVATE_EVAL_AUX_IF_, cond)((x), (y))
#define AGONY_PP_PRIVATE_EVAL_AUX_IF_0(_x, y) AGONY_PP_PRIVATE_EVAL_AUX_UNPARENTHESISE(y)
#define AGONY_PP_PRIVATE_EVAL_AUX_IF_1(x, _y) AGONY_PP_PRIVATE_EVAL_AUX_UNPARENTHESISE(x)

#endif // AGONY_PP_PRIVATE_AUX_H
